{"posts":[{"title":".htaccess设置thinkphp运行目录及伪静态","content":"根目录 .htaccess 内容: RewriteEngine on RewriteBase / RewriteCond %{REQUEST_URI} !^/public/ RewriteRule ^(.*)$ /public/$1 [L] public 为 目录名 下面是 public 目录的 .htaccess 配置 # Options +FollowSymlinks -Multiviews RewriteEngine On RewriteCond %{REQUEST_FILENAME} !-d RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^(.*)$ index.php?s=$1 [QSA,PT,L] DirectoryIndex index.html index.php DirectoryIndex 默认首页文件顺序 按需求添加修改 Options +FollowSymlinks -Multiviews 有些空间需要这条配置有的则会造成500错误 去掉 # 解除屏蔽 ","link":"https://mingwusuowei.github.io/post/htaccess-she-zhi-thinkphp-yun-xing-mu-lu-ji-wei-jing-tai/"},{"title":"付费测试","content":"以下内容需要付费才能够查看 document.writeln(\"\"); document.writeln(\"内容&nbsp;&nbsp;元以上,选择\"); document.writeln(\"\"); document.writeln(\"微信支付支付宝支付\"); document.writeln(\"支付\"); document.writeln(\"订单号&nbsp;\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); var Order = $.getUrlParam('Order'); window.onload = function(){ $(\"#dingdanhao\").val(Order); if (document.getElementById(\"dingdanhao\").value != ''){ cx(); } } var urls = hex_md5(window.location.pathname).substr(8,16); $(\"#payId\").val(urls + new Date().getTime()); $(\"#param\").val(window.location.href); function zf() { var p = \"payId=\"+$(\"#payId\").val() + \"&price=\"+$(\"#price\").val()+\"&param=\"+$(\"#param\").val()+\"&type=\"+$(\"#type\").val(); window.location.href = \"https://dh.feifan.ga/example/main.php?\" + p; } function yztest (defaultVal) { document.getElementById(\"pwd\").value = defaultVal; } var mwtxt = document.getElementById(\"mwtxt\").value; document.getElementById(\"Ciphertexts\").value = mwtxt; function test (defaultVal) { document.getElementById(\"Ciphertexts\").value = defaultVal; } function cx(){ var curl = 'https://dh.feifan.ga/getOrder?orderId=' + document.getElementById(\"dingdanhao\").value; $.getJSON(curl,function(data){ //$('#').append('state:'+data.data.state+''); jQuery(\"input[id=yzmm]\").val(data.data.state); var pid = data.data.payId.substr(0,16); if (pid == hex_md5(window.location.pathname).substr(8,16)){ yzjs(); } }); } function yzjs(){ var constr = $(\"#yztxt\").val(); var pwdstr = document.getElementById(\"yzmm\").value; //var pwdstr = pwds.split('').reverse().join(''); var desstr = CryptoJS.RC4.decrypt(constr, pwdstr).toString(CryptoJS.enc.Utf8); $(\"#pwd\").val(desstr); var constr = $(\"#Ciphertexts\").val(); var pwdstr = document.getElementById(\"pwd\").value; //var pwdstr = pwds.split('').reverse().join(''); var desstr = CryptoJS.RC4.decrypt(constr, pwdstr).toString(CryptoJS.enc.Utf8); $(\"#contentmw\").val(desstr); document.getElementById(\"pwd\").style.display=\"none\"; document.getElementById(\"Ciphertext\").style.display=\"block\"; } ","link":"https://mingwusuowei.github.io/post/fu-fei-ce-shi/"},{"title":"JSProxy 反代","content":"'use strict' /** * static files (404.html, sw.js, conf.js) */ const ASSET_URL = '这里替换反代的地址,注意以 http:// 或 https:// 开头' const JS_VER = 8 const MAX_RETRY = 1 const PREFLIGHT_INIT = { status: 204, headers: new Headers({ 'access-control-allow-origin': '*', 'access-control-allow-methods': 'GET,POST,PUT,PATCH,TRACE,DELETE,HEAD,OPTIONS', 'access-control-allow-headers': '--raw-info,--level,--url,--referer,--cookie,--origin,--ext,--aceh,--ver,--type,--mode,accept,accept-charset,accept-encoding,accept-language,accept-datetime,authorization,cache-control,content-length,content-type,date,if-match,if-modified-since,if-none-match,if-range,if-unmodified-since,max-forwards,pragma,range,te,upgrade,upgrade-insecure-requests,x-requested-with,chrome-proxy,purpose', 'access-control-max-age': '1728000', }), } /** * @param {string} message * @param {number} status * @param {any} headers */ function makeRes(message, status = 200, headers = {}) { headers['cache-control'] = 'no-cache' headers['vary'] = '--url' headers['access-control-allow-origin'] = '*' return new Response(message, {status, headers}) } addEventListener('fetch', e =&gt; { const ret = fetchHandler(e) .catch(err =&gt; makeRes('cfworker error:' + err, 502)) e.respondWith(ret) }) function fetchHandler(e) { const req = e.request const urlStr = req.url const urlObj = new URL(urlStr) if (urlObj.protocol === 'http:') { urlObj.protocol = 'https:' return makeRes('', 301, { 'strict-transport-security': 'max-age=99999999; includeSubDomains; preload', 'location': urlObj.href, }) } switch (urlObj.pathname) { case '/http': return httpHandler(req) case '/ws': return makeRes('not support', 400) case '/works': return makeRes('it works') default: // static files return fetch(ASSET_URL + urlObj.pathname) } } /** * @param {Request} req */ async function httpHandler(req) { const reqHdrRaw = req.headers if (reqHdrRaw.has('x-jsproxy')) { return Response.error() } // preflight if (req.method === 'OPTIONS' &amp;&amp; reqHdrRaw.has('access-control-request-headers') ) { return new Response(null, PREFLIGHT_INIT) } let urlObj = null let extHdrs = null let acehOld = false let rawSvr = '' let rawLen = '' let rawEtag = '' const reqHdrNew = new Headers(reqHdrRaw) reqHdrNew.set('x-jsproxy', '1') for (const [k, v] of reqHdrRaw.entries()) { if (!k.startsWith('--')) { continue } reqHdrNew.delete(k) const k2 = k.substr(2) switch (k2) { case 'url': urlObj = new URL(v) break case 'aceh': acehOld = true break case 'raw-info': [rawSvr, rawLen, rawEtag] = v.split('|') break case 'level': case 'mode': case 'type': break case 'ext': extHdrs = JSON.parse(v) break default: if (v) { reqHdrNew.set(k2, v) } else { reqHdrNew.delete(k2) } break } } if (extHdrs) { for (const [k, v] of Object.entries(extHdrs)) { reqHdrNew.set(k, v) } } if (!urlObj) { return makeRes('missing url param', 403) } /** @type {RequestInit} */ const reqInit = { method: req.method, headers: reqHdrNew, } if (req.method === 'POST') { reqInit.body = req.body } return proxy(urlObj, reqInit, acehOld, rawLen, 0) } /** * * @param {URL} urlObj * @param {RequestInit} reqInit * @param {number} retryTimes */ async function proxy(urlObj, reqInit, acehOld, rawLen, retryTimes) { const res = await fetch(urlObj.href, reqInit) const resHdrOld = res.headers const resHdrNew = new Headers(resHdrOld) let expose = '*' let vary = '--url' for (const [k, v] of resHdrOld.entries()) { if (k === 'access-control-allow-origin' || k === 'access-control-expose-headers' || k === 'location' || k === 'set-cookie' ) { const x = '--' + k resHdrNew.set(x, v) if (acehOld) { expose = expose + ',' + x } resHdrNew.delete(k) } else if (k === 'vary') { vary = vary + ',' + v } else if (acehOld &amp;&amp; k !== 'cache-control' &amp;&amp; k !== 'content-language' &amp;&amp; k !== 'content-type' &amp;&amp; k !== 'expires' &amp;&amp; k !== 'last-modified' &amp;&amp; k !== 'pragma' ) { expose = expose + ',' + k } } if (acehOld) { expose = expose + ',--s' resHdrNew.set('--t', '1') } // verify if (rawLen) { const newLen = resHdrOld.get('content-length') || '' const badLen = (rawLen !== newLen) if (badLen) { if (retryTimes &lt; MAX_RETRY) { urlObj = await parseYtVideoRedir(urlObj, newLen, res) if (urlObj) { return proxy(urlObj, reqInit, acehOld, rawLen, retryTimes + 1) } } return makeRes('error', 400, { '--error': 'bad len:' + newLen }) } if (retryTimes &gt; 1) { resHdrNew.set('--retry', retryTimes) } } let status = res.status resHdrNew.set('access-control-expose-headers', expose) resHdrNew.set('access-control-allow-origin', '*') resHdrNew.set('vary', vary) resHdrNew.set('--s', status) resHdrNew.set('--ver', JS_VER) resHdrNew.delete('content-security-policy') resHdrNew.delete('content-security-policy-report-only') if (status === 301 || status === 302 || status === 303 || status === 307 || status === 308 ) { status = status + 10 } return new Response(res.body, { status, headers: resHdrNew, }) } /** * @param {URL} urlObj */ function isYtUrl(urlObj) { return ( urlObj.host.endsWith('.googlevideo.com') &amp;&amp; urlObj.pathname.startsWith('/videoplayback') ) } /** * @param {URL} urlObj * @param {number} newLen * @param {Response} res */ async function parseYtVideoRedir(urlObj, newLen, res) { if (newLen &gt; 2000) { return null } if (!isYtUrl(urlObj)) { return null } try { const data = await res.text() urlObj = new URL(data) } catch (err) { return null } if (!isYtUrl(urlObj)) { return null } return urlObj } ","link":"https://mingwusuowei.github.io/post/jsproxy-fan-dai/"},{"title":"静态博文内容加密解密","content":"这里使用rc4进行实例,密文即密码有效的防止密码外泄 代码有点乱,但不妨碍使用,有能力的可以自行修改 首先使用RC4对文本进行加密 比如原文本:你已输入了正确的密码,这里是加密的内容! RC4密码123456 加密后的文本 U2FsdGVkX1/Q9vFOkyJ5g6/YuxIewhi3gGVFY56UTPgLMUfGuidsaMrW3Q2vTbDy DDvlv/wH3ZfxUw+olIfSLxLcwtKSM17D 将加密后的文本替换下面的&quot;密文&quot;中 &lt;input type=&quot;text&quot; id=&quot;mwtxt&quot; value=&quot;密文&quot; onkeyup=&quot;test(this.value);&quot; style=&quot;display:none&quot;/&gt; &lt;script type=&quot;text/javascript&quot;&gt; document.writeln(&quot;&lt;input name=\\&quot;pwd\\&quot; type=\\&quot;text\\&quot; id=\\&quot;pwd\\&quot; placeholder=\\&quot;请输入密码\\&quot; onkeypress=\\&quot;if(event.keyCode==13) {GOSubmit.click();return false;}\\&quot;/&gt;&quot;); document.writeln(&quot;&lt;input id=\\&quot;GOSubmit\\&quot; type=\\&quot;submit\\&quot; name=\\&quot;Submit\\&quot; value=\\&quot;Go\\&quot; onclick=\\&quot;Decrypt()\\&quot;/&gt;&quot;); document.writeln(&quot;&lt;div id=\\&quot;Ciphertext\\&quot; style=\\&quot;display:none\\&quot;&gt;&quot;); document.writeln(&quot;&lt;input id=\\&quot;Ciphertexts\\&quot; name=\\&quot;Ciphertexts\\&quot; type=\\&quot;text\\&quot; value=\\&quot;\\&quot; style=\\&quot;display:none\\&quot;/&gt;&quot;); document.writeln(&quot;&lt;textarea id=\\&quot;contentmw\\&quot; name=\\&quot;contentmw\\&quot; rows=\\&quot;10\\&quot; cols=\\&quot;100\\&quot; style= \\&quot;overflow-x:hidden;overflow-y:hidden\\&quot;&gt;&lt;/textarea&gt;&quot;); document.writeln(&quot;&lt;/div&gt;&quot;); var mwtxt = document.getElementById(&quot;mwtxt&quot;).value; document.getElementById(&quot;Ciphertexts&quot;).value = mwtxt; function test (defaultVal) { document.getElementById(&quot;Ciphertexts&quot;).value = defaultVal; } &lt;/script&gt; 上面的代码放到博文中即可,效果在结尾 下面是解密需要的代码,可以放到网站底部或其他适合的地方 &lt;script src=&quot;https://mingwusuowei.github.io/media/scripts/jquery-1.11.3.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;https://mingwusuowei.github.io/media/scripts/rc4.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot;&gt; function Decrypt(){ var constr = $(&quot;#Ciphertexts&quot;).val(); var pwdstr = document.getElementById(&quot;pwd&quot;).value; var desstr = CryptoJS.RC4.decrypt(constr, pwdstr).toString(CryptoJS.enc.Utf8); $(&quot;#contentmw&quot;).val(desstr); document.getElementById(&quot;pwd&quot;).style.display=&quot;none&quot;; document.getElementById(&quot;GOSubmit&quot;).style.display=&quot;none&quot;; document.getElementById(&quot;Ciphertext&quot;).style.display=&quot;block&quot;; } &lt;/script&gt; 站点原有jquery会造成冲突 可以把这条去掉 &lt;script src=&quot;https://mingwusuowei.github.io/media/scripts/jquery-1.11.3.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt; 效果如下,密码是123456 document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); var mwtxt = document.getElementById(\"mwtxt\").value; document.getElementById(\"Ciphertexts\").value = mwtxt; function test (defaultVal) { document.getElementById(\"Ciphertexts\").value = defaultVal; } function Decrypt(){ var constr = $(\"#Ciphertexts\").val(); var pwds = document.getElementById(\"pwd\").value; var pwdstr = pwds.split('').reverse().join(''); var desstr = CryptoJS.RC4.decrypt(constr, pwdstr).toString(CryptoJS.enc.Utf8); $(\"#contentmw\").val(desstr); document.getElementById(\"pwd\").style.display=\"none\"; document.getElementById(\"GOSubmit\").style.display=\"none\"; document.getElementById(\"Ciphertext\").style.display=\"block\"; } ","link":"https://mingwusuowei.github.io/post/jing-tai-bo-wen-nei-rong-jia-mi-jie-mi/"},{"title":"加密测试","content":"以下内容需要输入正确的密码才能查看,测试密码:123456 document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); document.writeln(\"\"); var mwtxt = document.getElementById(\"mwtxt\").value; document.getElementById(\"Ciphertexts\").value = mwtxt; function test (defaultVal) { document.getElementById(\"Ciphertexts\").value = defaultVal; } function Decrypt(){ var constr = $(\"#Ciphertexts\").val(); var pwds = document.getElementById(\"pwd\").value; var pwdstr = pwds.split('').reverse().join(''); var desstr = CryptoJS.RC4.decrypt(constr, pwdstr).toString(CryptoJS.enc.Utf8); $(\"#contentmw\").val(desstr); document.getElementById(\"pwd\").style.display=\"none\"; document.getElementById(\"GOSubmit\").style.display=\"none\"; document.getElementById(\"Ciphertext\").style.display=\"block\"; } ","link":"https://mingwusuowei.github.io/post/jia-mi-ce-shi/"},{"title":"RC4在线加密解密","content":" function rc4jia() { var constr = $(\"#jiajiemi\").val(); var pwdstr = $(\"#mima\").val(); if (constr == \"\" || constr == null) { return false; } $(\"#jieguo\").val(CryptoJS.RC4.encrypt(constr, pwdstr)); } function rc4jie() { var constr = $(\"#jiajiemi\").val(); var pwdstr = $(\"#mima\").val(); if (constr == \"\" || constr == null) { return false; } var desstr = CryptoJS.RC4.decrypt(constr, pwdstr).toString(CryptoJS.enc.Utf8); $(\"#jieguo\").val(desstr); } function resetAll() { $(\"#mima\").val(\"\"); $(\"#jiajiemi\").val(\"\"); $(\"#jieguo\").val(\"\"); document.getElementById(\"jiajiemi\").select(); } function Copy() { var copy = document.getElementById('jieguo'); copy.select(); document.execCommand('Copy'); alert('复制完成!') } ","link":"https://mingwusuowei.github.io/post/rc4-zai-xian-jia-mi-jie-mi/"}]}